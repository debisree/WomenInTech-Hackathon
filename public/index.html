<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ADHDecode</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <nav id="top-nav" class="top-nav hidden">
    <div class="nav-brand">ADHDecode</div>
    <div class="nav-links">
      <button class="nav-btn active" data-target="screen-welcome" id="nav-home">Home</button>
      <button class="nav-btn" data-target="screen-demographics" id="nav-info">My Info</button>
      <button class="nav-btn" data-target="screen-status" id="nav-status">Status</button>
      <button class="nav-btn" data-target="screen-tests" id="nav-tests">Tests</button>
      <button class="nav-btn" data-target="screen-dashboard" id="nav-dashboard">Dashboard</button>
      <button class="nav-btn nav-logout" id="nav-logout">Logout</button>
    </div>
  </nav>

  <div id="app">

    <div id="screen-login" class="screen active">
      <div class="card login-card">
        <div class="logo">
          <h1>ADHDecode</h1>
          <p class="subtitle">Likelihood Analysis Tool</p>
        </div>
        <form id="login-form">
          <div class="form-group">
            <label for="username">Username</label>
            <input type="text" id="username" placeholder="Enter your name" autocomplete="username">
          </div>
          <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" placeholder="Enter password" autocomplete="current-password">
          </div>
          <div class="form-group" id="confirm-password-group" style="display:none;">
            <label for="confirm-password">Confirm Password</label>
            <input type="password" id="confirm-password" placeholder="Re-enter password" autocomplete="new-password">
          </div>
          <button type="submit" id="auth-submit-btn" class="btn btn-primary btn-full">Sign In</button>
          <p class="auth-toggle-text">Don't have an account? <a href="#" id="toggle-to-register">Create one</a></p>
          <div class="divider"><span>or</span></div>
          <button type="button" id="guest-btn" class="btn btn-outline btn-full">Continue as Guest</button>
        </form>
        <p id="login-error" class="error-text"></p>
      </div>
    </div>

    <div id="screen-welcome" class="screen">
      <div class="card welcome-card">
        <h1>Welcome, <span id="welcome-name"></span>!</h1>
        <p class="welcome-text">You are about to take an ADHD likelihood screening. This process involves a few simple steps before you begin the tests.</p>
        <div class="steps-preview">
          <div class="step-item" id="step-consent">
            <div class="step-num">1</div>
            <span>Consent Agreement</span>
            <span class="step-status" id="step-consent-status"></span>
          </div>
          <div class="step-item">
            <div class="step-num">2</div>
            <span>Basic Information</span>
            <span class="step-status" id="step-info-status"></span>
          </div>
          <div class="step-item">
            <div class="step-num">3</div>
            <span>Current Status</span>
            <span class="step-status" id="step-status-status"></span>
          </div>
          <div class="step-item">
            <div class="step-num">4</div>
            <span>Take Screening Tests</span>
          </div>
        </div>
        <button id="welcome-continue" class="btn btn-primary btn-full">Let's Get Started</button>
      </div>
    </div>

    <div id="screen-consent" class="screen">
      <div class="card consent-card">
        <h1>Consent Agreement</h1>
        <p class="consent-subtitle">Please read and acknowledge the following before proceeding.</p>
        <div class="consent-box">
          <div class="consent-item">
            <div class="consent-icon">&#9989;</div>
            <p>I confirm that I am an <strong>adult aged 18 years or older</strong>.</p>
          </div>
          <div class="consent-item">
            <div class="consent-icon">&#9989;</div>
            <p>I understand that this screening tool provides a <strong>likelihood analysis only</strong> and is <strong>not a medical diagnosis</strong>.</p>
          </div>
          <div class="consent-item">
            <div class="consent-icon">&#9989;</div>
            <p>I understand that the results of this screening should <strong>not replace professional medical advice</strong>, diagnosis, or treatment.</p>
          </div>
          <div class="consent-item">
            <div class="consent-icon">&#9989;</div>
            <p>I acknowledge that I am taking this test <strong>voluntarily</strong> for informational purposes.</p>
          </div>
        </div>
        <div class="consent-check">
          <label class="checkbox-label">
            <input type="checkbox" id="consent-checkbox">
            <span class="checkmark"></span>
            <span>I have read and agree to all the above statements</span>
          </label>
        </div>
        <button id="consent-continue" class="btn btn-primary btn-full" disabled>I Agree & Continue</button>
      </div>
    </div>

    <div id="screen-demographics" class="screen">
      <div class="card demographics-card">
        <h1>Tell Us About Yourself</h1>
        <p class="demo-subtitle">This information helps contextualize your screening results. You can update this anytime.</p>
        <form id="demographics-form">
          <div class="form-group">
            <label>Gender</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="gender" value="Female">
                <span class="radio-btn"></span>
                <span>Female</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="gender" value="Male">
                <span class="radio-btn"></span>
                <span>Male</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="gender" value="Non-binary">
                <span class="radio-btn"></span>
                <span>Non-binary</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="gender" value="Prefer not to say">
                <span class="radio-btn"></span>
                <span>Prefer not to say</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Age Group</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="ageGroup" value="18-25">
                <span class="radio-btn"></span>
                <span>18 - 25</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ageGroup" value="26-35">
                <span class="radio-btn"></span>
                <span>26 - 35</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ageGroup" value="36-45">
                <span class="radio-btn"></span>
                <span>36 - 45</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ageGroup" value="46-55">
                <span class="radio-btn"></span>
                <span>46 - 55</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ageGroup" value="56-65">
                <span class="radio-btn"></span>
                <span>56 - 65</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ageGroup" value=">65">
                <span class="radio-btn"></span>
                <span>> 65</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Ethnicity</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="ethnicity" value="White">
                <span class="radio-btn"></span>
                <span>White</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ethnicity" value="Black">
                <span class="radio-btn"></span>
                <span>Black</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ethnicity" value="Pacific Islander">
                <span class="radio-btn"></span>
                <span>Pacific Islander</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ethnicity" value="Asian">
                <span class="radio-btn"></span>
                <span>Asian</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ethnicity" value="South Asian">
                <span class="radio-btn"></span>
                <span>South Asian</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ethnicity" value="Two or More Races">
                <span class="radio-btn"></span>
                <span>Two or More Races</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="ethnicity" value="Other">
                <span class="radio-btn"></span>
                <span>Other</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Have you ever been diagnosed with ADHD?</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="adhdDiagnosed" value="Yes">
                <span class="radio-btn"></span>
                <span>Yes</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="adhdDiagnosed" value="No">
                <span class="radio-btn"></span>
                <span>No</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="adhdDiagnosed" value="Not sure">
                <span class="radio-btn"></span>
                <span>Not sure</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="adhdDiagnosed" value="Prefer not to say">
                <span class="radio-btn"></span>
                <span>Prefer not to say</span>
              </label>
            </div>
          </div>

          <p id="demo-saved-msg" class="success-text"></p>
          <button type="submit" class="btn btn-primary btn-full" id="demo-submit" disabled>Save & Continue</button>
        </form>
      </div>
    </div>

    <div id="screen-status" class="screen">
      <div class="card demographics-card">
        <h1>Current Status</h1>
        <p class="demo-subtitle">Tell us how you're feeling right now. This helps us interpret your test results more accurately. You can update this anytime.</p>
        <form id="status-form">
          <div class="form-group">
            <label>Sleep quality last night</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="sleepQuality" value="Very Poor">
                <span class="radio-btn"></span>
                <span>Very Poor</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="sleepQuality" value="Poor">
                <span class="radio-btn"></span>
                <span>Poor</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="sleepQuality" value="Fair">
                <span class="radio-btn"></span>
                <span>Fair</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="sleepQuality" value="Good">
                <span class="radio-btn"></span>
                <span>Good</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="sleepQuality" value="Excellent">
                <span class="radio-btn"></span>
                <span>Excellent</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Caffeine intake today</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="caffeineIntake" value="None">
                <span class="radio-btn"></span>
                <span>None</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="caffeineIntake" value="Low (1 cup)">
                <span class="radio-btn"></span>
                <span>Low (1 cup)</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="caffeineIntake" value="Moderate (2-3 cups)">
                <span class="radio-btn"></span>
                <span>Moderate (2-3 cups)</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="caffeineIntake" value="High (4+ cups)">
                <span class="radio-btn"></span>
                <span>High (4+ cups)</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Current focus level</label>
            <div class="radio-group radio-group-inline">
              <label class="radio-label">
                <input type="radio" name="focusLevel" value="1">
                <span class="radio-btn"></span>
                <span>1</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="focusLevel" value="2">
                <span class="radio-btn"></span>
                <span>2</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="focusLevel" value="3">
                <span class="radio-btn"></span>
                <span>3</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="focusLevel" value="4">
                <span class="radio-btn"></span>
                <span>4</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="focusLevel" value="5">
                <span class="radio-btn"></span>
                <span>5</span>
              </label>
            </div>
            <div class="focus-scale-labels">
              <span>Very unfocused</span>
              <span>Very focused</span>
            </div>
          </div>

          <div class="form-group">
            <label>Do you frequently lose track of time?</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="loseTrackOfTime" value="Never">
                <span class="radio-btn"></span>
                <span>Never</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="loseTrackOfTime" value="Rarely">
                <span class="radio-btn"></span>
                <span>Rarely</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="loseTrackOfTime" value="Sometimes">
                <span class="radio-btn"></span>
                <span>Sometimes</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="loseTrackOfTime" value="Often">
                <span class="radio-btn"></span>
                <span>Often</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="loseTrackOfTime" value="Very Often">
                <span class="radio-btn"></span>
                <span>Very Often</span>
              </label>
            </div>
          </div>

          <p id="status-saved-msg" class="success-text"></p>
          <button type="submit" class="btn btn-primary btn-full" id="status-submit" disabled>Save & Continue to Tests</button>
        </form>
      </div>
    </div>

    <div id="screen-tests" class="screen">
      <div class="card tests-card">
        <h1>Screening Tests</h1>
        <p class="tests-subtitle">Please complete the following tests. Each one takes only a few minutes.</p>
        <div class="test-list">
          <div class="test-card" id="test-1-card">
            <div class="test-info">
              <div class="test-badge">Test 1</div>
              <h3>Time Perception Challenge</h3>
              <p>Estimate time intervals to measure your internal clock consistency.</p>
              <p class="test-status" id="test1-status"></p>
            </div>
            <button class="btn btn-primary" id="start-test-1">Start Test</button>
          </div>
          <div class="test-card" id="test-2-card">
            <div class="test-info">
              <div class="test-badge">Test 2</div>
              <h3>Coming Soon</h3>
              <p>This test will be available shortly.</p>
            </div>
            <button class="btn btn-outline" disabled>Not Available</button>
          </div>
        </div>
      </div>
    </div>

    <div id="screen-tp-intro" class="screen">
      <div class="card tp-card">
        <h1>Time Perception Challenge</h1>
        <p class="tp-subtitle">This test measures how accurately you can estimate time intervals using your internal sense of time.</p>
        <div class="tp-instructions">
          <div class="tp-instruction-item">
            <strong>How it works:</strong>
            <p>You will see a target time (e.g., "12 seconds"). Press START, wait until you think that amount of time has passed, then press STOP.</p>
          </div>
          <div class="tp-instruction-item">
            <strong>Important rules:</strong>
            <ul>
              <li>Do NOT count in your head (e.g., "one-Mississippi...")</li>
              <li>Do NOT use any external timers, clocks, or watches</li>
              <li>Just rely on your gut feeling of how long the time is</li>
            </ul>
          </div>
          <div class="tp-instruction-item">
            <strong>Test structure:</strong>
            <p>2 practice trials (not scored) followed by 8 scored trials. No feedback is given between trials.</p>
          </div>
        </div>
        <div class="tp-disclaimer">
          This is not a diagnosis. Results may be influenced by sleep, stress, caffeine, or medications. Consider validated screeners and consult a clinician for professional assessment.
        </div>
        <button id="tp-begin" class="btn btn-primary btn-full">Begin Test</button>
      </div>
    </div>

    <div id="screen-tp-trial" class="screen">
      <div class="card tp-trial-card">
        <div class="tp-progress">
          <span id="tp-trial-label">Practice 1 of 2</span>
          <div class="tp-progress-bar">
            <div class="tp-progress-fill" id="tp-progress-fill"></div>
          </div>
        </div>
        <div class="tp-target">
          <span>Target Time</span>
          <div class="tp-target-time" id="tp-target-time">12 seconds</div>
        </div>
        <div class="tp-status" id="tp-status">Press START when ready</div>
        <div class="tp-buttons">
          <button id="tp-start-btn" class="btn btn-primary tp-action-btn">START</button>
          <button id="tp-stop-btn" class="btn btn-primary tp-action-btn tp-stop" disabled>STOP</button>
        </div>
      </div>
    </div>

    <div id="screen-tp-results" class="screen">
      <div class="card tp-results-card">
        <h1>Your Results</h1>
        <div class="tp-score-circle" id="tp-score-circle">
          <span class="tp-score-num" id="tp-score-num">--</span>
          <span class="tp-score-label">Time Control Score</span>
        </div>
        <div class="tp-category" id="tp-category">--</div>

        <div class="tp-breakdown">
          <h3>How we got your score</h3>
          <p class="tp-breakdown-intro">We combine two factors: how close your estimates were to the target (Accuracy, 60%) and how steady your performance was across trials (Consistency, 40%). Lower error and steadier performance = higher score.</p>
          <div class="tp-breakdown-row">
            <div class="tp-breakdown-label">
              <span>Accuracy</span>
              <span class="tp-breakdown-weight">60%</span>
            </div>
            <div class="tp-breakdown-bar-wrap">
              <div class="tp-breakdown-bar tp-bar-acc" id="tp-acc-bar"></div>
            </div>
            <span class="tp-breakdown-val" id="tp-acc-val">--</span>
          </div>
          <div class="tp-breakdown-row">
            <div class="tp-breakdown-label">
              <span>Consistency</span>
              <span class="tp-breakdown-weight">40%</span>
            </div>
            <div class="tp-breakdown-bar-wrap">
              <div class="tp-breakdown-bar tp-bar-con" id="tp-con-bar"></div>
            </div>
            <span class="tp-breakdown-val" id="tp-con-val">--</span>
          </div>
        </div>

        <div class="tp-metrics">
          <div class="tp-metric">
            <span class="tp-metric-label">Avg. Error</span>
            <span class="tp-metric-value" id="tp-mae">--</span>
          </div>
          <div class="tp-metric">
            <span class="tp-metric-label">Variability</span>
            <span class="tp-metric-value" id="tp-variability">--</span>
          </div>
          <div class="tp-metric">
            <span class="tp-metric-label">Bias</span>
            <span class="tp-metric-value" id="tp-bias">--</span>
          </div>
        </div>

        <div class="tp-chart-section">
          <h3>Error per trial</h3>
          <div id="tp-error-chart"></div>
        </div>

        <p class="tp-summary" id="tp-summary-text"></p>

        <div class="tp-table-wrap">
          <table class="tp-table" id="tp-results-table">
            <thead>
              <tr><th>Target (s)</th><th>Your Time (s)</th><th>Off By (s)</th><th>Direction</th></tr>
            </thead>
            <tbody id="tp-results-tbody"></tbody>
          </table>
        </div>

        <details class="tp-details-toggle">
          <summary>Scoring details</summary>
          <div class="tp-details-content" id="tp-details-content"></div>
        </details>

        <div class="tp-disclaimer">
          Not a diagnosis. Results may be influenced by sleep, stress, caffeine, or medications. Consider validated screeners and consult a clinician for professional assessment.
        </div>
        <div class="tp-retake-tip">
          For best results: be rested, avoid distractions, don't count.
        </div>
        <div class="tp-result-actions">
          <button id="tp-retake" class="btn btn-outline">Retake Test</button>
          <button id="tp-back-tests" class="btn btn-primary">Back to Tests</button>
        </div>
      </div>
    </div>

    <div id="screen-dashboard" class="screen">
      <div class="card dash-card">
        <h1>Your ADHDecode Dashboard</h1>
        <p class="dash-subtitle">This is a screening signal, not a diagnosis. Your results are for informational purposes only.</p>

        <div class="dash-score-section" id="dash-score-section">
          <div class="dash-score-circle" id="dash-score-circle">
            <span class="dash-score-num" id="dash-score-num">--</span>
            <span class="dash-score-label">Signal Score</span>
          </div>
          <div class="dash-bucket" id="dash-bucket">--</div>
          <div class="dash-confidence" id="dash-confidence"></div>
        </div>

        <div class="dash-breakdown" id="dash-breakdown">
          <h3>Score breakdown</h3>
          <p class="dash-breakdown-intro" id="dash-breakdown-intro"></p>
          <div id="dash-breakdown-bars"></div>
        </div>

        <div class="dash-tests-section">
          <h3>Individual tests</h3>
          <div id="dash-test-cards"></div>
        </div>

        <div class="dash-status-note" id="dash-status-note" style="display:none;"></div>

        <div class="tp-disclaimer">
          Not a diagnosis. Results can be influenced by sleep, stress, caffeine, medications, anxiety, depression, environment, and device latency. For concerns, consider validated screeners and talk to a clinician.
        </div>

        <div class="dash-next-steps">
          <p>If you're concerned, consider taking a validated screener (e.g., ASRS) and discussing results with a clinician.</p>
          <p>Try retaking tests when rested and distraction-free for more reliable results.</p>
        </div>

        <div class="dash-actions">
          <button class="btn btn-outline btn-full" id="dash-go-tests">Take More Tests</button>
        </div>
      </div>
    </div>

  </div>

  <script src="app.js"></script>
  <script src="time-perception.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>
